function domReady(){return new Promise(function(t){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",t):t()})}var __awaiter=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function u(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(a=(a=c.trys).length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){c.label=r[1];break}if(6===r[0]&&c.label<a[1]){c.label=a[1],a=r;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(r);break}a[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(n){r=[6,n],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,u,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u};import{Dispatcher}from"./dispatcher";import{Router}from"./router";import{defaultSchema}from"./schema";var Application=function(){function t(t,e){void 0===t&&(t=document.documentElement),void 0===e&&(e=defaultSchema),this.element=t,this.schema=e,this.dispatcher=new Dispatcher(this),this.router=new Router(this)}return t.start=function(e,r){var n=new t(e,r);return n.start(),n},t.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,domReady()];case 1:return t.sent(),this.router.start(),this.dispatcher.start(),[2]}})})},t.prototype.stop=function(){this.router.stop(),this.dispatcher.stop()},t.prototype.register=function(t,e){this.load({identifier:t,controllerConstructor:e})},t.prototype.load=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(Array.isArray(t)?t:[t].concat(r)).forEach(function(t){return e.router.loadDefinition(t)})},t.prototype.unload=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(Array.isArray(t)?t:[t].concat(r)).forEach(function(t){return e.router.unloadIdentifier(t)})},Object.defineProperty(t.prototype,"controllers",{get:function(){return this.router.contexts.map(function(t){return t.controller})},enumerable:!0,configurable:!0}),t.prototype.getControllerForElementAndIdentifier=function(t,e){var r=this.router.getContextForElementAndIdentifier(t,e);return r?r.controller:null},t.prototype.handleError=function(t,e,r){console.error("%s\n\n%o\n\n%o",e,t,r)},t}();export{Application};